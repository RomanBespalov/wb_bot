# wb_bot  
telegram bot for Wildberries  

Задачу, которую должен решать бот:  
1. В боте должно быть меню из 3 кнопок: «Получить информацию по товару», «Остановить уведомления», «получить информацию из БД».  
2. Нажимая на кнопку «Получить информацию по товару» Пользователь отправляет в бота артикул товара с Wildsberries (например: 211695539).  
3. Бот должен выдать информацию о товаре (карточке) - Название, артикул, цена, рейтинг товара, количество товара НА ВСЕХ СКЛАДАХ. Все эти данные легко получаются по запросу: https://card.wb.ru/cards/v1/detail?appType=1&curr=rub&dest=-1257786&spp=30&nm={артикул товара}  
4. Под сообщением, которые присылает бот должна быть inline-кнопка - «подписаться». По нажатию на которую должны приходить уведомления в бот каждые 5 минут с сообщением, что было выше. (Название, артикул, цена, рейтинг товара, количество товара НА ВСЕХ СКЛАДАХ)  
5. При нажатии на кнопку «Остановить уведомления» - уведомления останавливаются.  
6. При нажатии на кнопку «получить информацию из БД» бот должен прислать сообщение с последними 5 записями из БД.  
Бот должен быть написан на Python 3.9+, с использованием библиотек: Aiogram 3. Уведомления должны быть написаны с использованием Celery.  Реализуйте взаимодействие с базой данных для сохранения истории запросов (используйте SQLAlchemy и PostgreSQL). Должны сохраняться id пользователя, время запроса, артикул товара. Бота упаковать в docker. Запустить на своем сервере. Прислать ссылку на бота. Прислать ссылку на репозиторий с кодом.  
## Замечания по коду  
Обработка ошибок:  
Ваш код не включает обработку возможных ошибок при выполнении запроса или обработки ответа. Рекомендуется добавить проверку статуса ответа и обработку возможных исключений.  
Использование функции .get():  
Используйте метод .get() для избежания исключения KeyError, если какие-то ключи отсутствуют в ответе.  
Использование requests в асинхронной функции:  
Код использует библиотеку requests в асинхронной функции, что неэффективно. Лучше использовать библиотеку, поддерживающую асинхронные вызовы, например, aiohttp.  
Логирование в Celery:  
Добавьте логирование в ваши задачи Celery для более удобного отслеживания событий.  
Использование async/await в Celery:  
В вашей задаче periodic_task есть вызов asyncio.run(send_notification_message(user_id, article)), который запускает асинхронную функцию в синхронном контексте. В Celery лучше использовать async/await напрямую вместо asyncio.run.  
Использование асинхронной сессии SQLAlchemy:  
Вы можете использовать асинхронную сессию SQLAlchemy (async_session), чтобы управлять асинхронными операциями с базой данных вместо использования SessionLocal. Это позволит вам избежать блокирования в асинхронном коде.  
